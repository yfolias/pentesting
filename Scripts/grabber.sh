#!/bin/bash
# Yannis Folias
# Quick and dirty banner grabber

today=`date +%Y-%m-%d.%H:%M:%S`

echo "[+] Provide IP for scanning: "
read ip
echo "[+] Provide name of target: "
read target
echo "[+] Scanning on $ip / $target begins... $today" | tee -a open

function identify_service(){
	case $port in 
		80)
			function p80_version() {
				timeout 2 curl -s -D - -o /dev/null "http://$ip" | head -3 | tail -2 | grep Server
			}
			p80_version
		;;
		443)
			function p443_version() {
				timeout 2 curl -s -D - -o /dev/null "https://$ip" | head -3 | tail -2
			}
			p443_version
		;;
		8080)
			function p8080_version() {
				timeout 2 curl -s -D - -o /dev/null "https://$ip" | head -3 | tail -2
			}
			p8080_version
		;;
		8443)
			function p8080_version() {
				timeout 2 curl -s -D - -o /dev/null "https://$ip" | head -3 | tail -2
			}
			p8080_version
		;;
		*)
			timeout 1 nc -q 0 -w 2 "$ip" "$port"
		;;
	esac
	
}
function top_scan(){


	for port in 21 22 23 25 53 80 88 110 111 135 139 443 445 464 1039 1521 2030 2100 3268 3269 3306 3389 7778 8080 8443 10000; do
		if ($({ exec 3<>/dev/tcp/$ip/$port; } > /dev/null 2>&1 )); then
			echo [+] $port is open | tee -a open
			identify_service
		fi
	done
}

top_scan


